<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN"
"http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta name="generator" content="HTML Tidy, see www.w3.org">
<link rev="made" href="mailto:taku-ku@is.aist-nara.ac.jp">
<title>CaboCha: Yet Another Japanese Dependency Structure
Analyzer</title>
<link type="text/css" rel="stylesheet" href="cabocha.css">
</head>
<body>
<h1>CaboCha における係り受け関係,文節切り,固有表現解析 の学習方法</h1>

<p>$Id: training.html 1076 2003-05-11 16:56:56Z taku-ku $;</p>

<hr>
<h2>学習の流れ</h2>

<ul>
<li>学習データの準備 
<p>
基本的に, cabocha -f1 の出力結果と同じフォーマットで学習データ
を作成すれば, それが学習データとなります. cabocha -f1 の出力
結果を人手で修正するとことで作成できると思います.
</p>

<p>
実際には, どの機能の学習を行うかで, 学習データのフォーマットが変わります. 
</p>

<pre>
固有表現解析:  cabocha -f1 -O1 -n1 の出力形式
文節区切り:    cabocha -f1 -O2 -n0 の出力形式
係り受け:      cabocha -f1 -O4 -n0 の出力形式
</pre>

京都大学コーパス を cabocha 用 係り受け学習データに変換するスクリプトが 
/usr/local/libexec/cabocha/kc2cabocha.pl としてインストールされます.
参考にしてみてください.
<pre>
/usr/local/libexec/cabocha/kc2cabocha.pl 950101.KNP &gt; train.dep
</pre>

</li>

<li>学習 

<p>cabocha-config を --libexecdir という
オプション で起動し, libexec の
ディレクトリを表示させます.<br>
 そのディレクトリにある Makefile を利用し,
学習を行ないます. まず, Makefile をローカルディレクトリにコピーしてください.</p>

<pre>
% cabocha-config --libexecdir
/usr/local/libexec/cabocha
% cp /usr/local/libexec/cabocha .
</pre>

以下の手順で学習を行います.
<pre>
固有表現解析
% make CORPUS=train.ne MODEL=case-study-ne train-ne

文節区切り
% make CORPUS=train.chunk MODEL=case-study-chunk train-chunk

かかり受け
% make CORPUS=train.dep MODEL=case-study-dep train-dep
</pre>

<p>Makefileに与える時の必須パラメータとして<b>CORPUS</b>と
<b>MODEL</b>があります.<br> <b>CORPUS</b>は,
前節で述べた学習データのファイルで,<br>
 <b>MODEL</b>は, 学習後に作成されるモデルファイルや,
各種中間ファイルの prefix となります.</p>

<p>上記の例では, <b>CORPUS</b>に train.(ne|chunk|dep) を,
<b>MODEL</b>に case-study-(ne|chunk|dep)を指定しています.</p>

<p>学習後に, 下記のファイルが生成されます</p>

<pre>
case_study-*.log           : 学習過程のログ
case_study-*.model         : バイナリ形式のモデル (アーキテクチャ依存)
case_study-*.svmdata       : 変換後の学習にデータ
case_study-*.txtmodel.gz   : テキスト形式のモデル (アーキテクチャ非依存)
</pre>
</li>

<li>テスト 
<p>case_study-(ne|chunk|dep).model が学習後のモデルです. 
このモデルを係り受け解析モデルとして使用します.</p>

<pre>
固有表現抽出
% cabocha -N case_study-ne.model &lt; INPUT

文節区切り
% cabocha -M  case_study-chunk.model &lt; INPUT

係り受け解析
% cabocha -m case_study-dep.model &lt; INPUT
</pre>

<br>
<br>
</li>
</ul>

<h2>係り受けに使用する素性の再定義</h2>

<div style="margin-left: 2em">
<p>係り受け解析に用いる素性をユーザ側で再定義して学習,
解析を行うことが可能です.<br>
具体的には, 自分で素性選択レイヤのプログラムを perl
等で記述し, その出力を, cabocha
の係り受け解析レイヤに入力するという流れになります.</p>

<p>素性には, 以下の 4つの種類があります.
それぞれ任意の文字列として与えますが, 先頭の一文字
(Prefix)により区別されます.</p>

<ul>
<li><b>静的素性</b>: Prefix <b>F</b><br>
 文節内の情報のみで決定される素性です. 例えば,
主辞や機能語の語彙, 品詞, 活用形
句読点の有無などが該当します.</li>

<li><b>間素性</b>: Prefix <b>G</b><br>
 今の着目する文節を挟む
2文節の係り関係の同定に使用されます. 例えば,
括弧の有無や 助詞の有無などが該当します.</li>

<li><b>動的素性 A</b>: Prefix <b>A</b><br>
 着目している係り元が係り先に係ると判定された時に,
係り元の動的素性 A が係り先に継承されます.<br>
<a href="#paper">論文</a>の動的素性
A,Bに相当します.</li>

<li><b>動的素性 B</b>: Prefix <b>B</b><br>
 着目している係り元が係り先に係ると判定された時に,
係り先の動的素性 B が係り元に継承されます.<br>
<a href="#paper">論文</a>の動的素性 C
に相当します.</li>
</ul>

<p>
これら4つの素性の関係を図示すると以下のようになります.</p>

<p><img src="./feature.png" alt="素性"></p>

<p>係り元と係り先の同定に,
図中の位置関係にある文節中の素性 F,G,A,B が使用
されます.<br>
具体例として<a href=
"3-out-4-in.txt">こちら</a>をご覧ください.</p>

<p>自分で素性を再定義した場合は,
素性選択レイヤまで終了したデータを使用するために,<br>
INPUT_LAYER=3 というオプションを指定する必要があります.<br>
<br>
テストデータも同様に素性選択レイヤまで終了したデータとして作成しておきます.</p>

<p><a href="selector.pl">こちら</a>に
<b>CaboCha</b>の selector
(入力データとして京大コーパスを指定)を Perl
で実装したものがありますので参考にしてみてください.</p>

<pre>
% ./selector.pl &lt; 950101.KNP &gt; train.selected
% make CORPUS=train.selected MODEL=foo INPUT_LAYER=3 train-dep
% ./selector.pl &lt; 950102.KNP | cabocha -m foo.model -I3 -O4 -f1
</pre>

</div>

<hr>
<p>$Id: training.html 1076 2003-05-11 16:56:56Z taku-ku $;</p>

<address>taku-ku@is.aist-nara.ac.jp</address>
</body>
</html>

