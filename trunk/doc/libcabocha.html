<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN"
"http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta name="generator" content="HTML Tidy, see www.w3.org">
<link rev="made" href="mailto:taku-ku@is.aist-nara.ac.jp">
<title>CaboCha: Yet Another Japanese Dependency Structure
Analyzer</title>
<link type="text/css" rel="stylesheet" href="cabocha.css">
</head>
<body>
<h1>C/C++/Perl/Ruby/Python ライブラリ</h1>

<p>$Id: libcabocha.html 1021 2003-01-30 17:26:15Z taku-ku $;</p>

<hr>
<h2>C ライブラリ仕様</h2>

<div style="margin-left: 2em">
<p><b>CaboCha</b>には, C/C++ 共用のライブラリ
(cabocha.h, libcabocha.so/licabocha.dll) があります.<br>
</p>

<p>C ライブラリは以下の関数を提供しています.</p>

<dl>
<dt><code><font color="#dc143c">cabocha_t *</font><font color=
"DarkBlue">cabocha_new</font>(int argc, char **argv)</code></dt>

<dd>cabocha のインスタンスを生成します.<br>
引数には, C 言語の, main 関数で使用される argc,
argv スタイルの引数を与えます.<br>
この引数は, <a href="cabocha.html">cabocha
コマンド</a>と同じ方法で処理されます.<br>
成功すれば, cabocha_t 型のポインタが返ってきます.
このポインタを通して解析を行います.<br>
</dd>

<dt><code><font color="#dc143c">cabocha_t *</font><font color=
"DarkBlue">cabocha_new2</font>(char *arg)</code></dt>

<dd>cabocha のインスタンスを生成します.<br>
引数には,
一つの文字列として表現したパラメータを与えます.<br>
この引数は, <a href="cabocha.html">cabocha
コマンド</a>と同じ方法で処理されますが,<br>
文字列を解釈するルーチンが貧弱なので留意してください.<br>
成功すれば, cabocha_t 型のポインタが返ってきます.
このポインタを通して解析を行います.<br>
</dd>

<dt><code><font color="#dc143c">char *</font><font color=
"DarkBlue">cabocha_sparse_tostr</font>(cabocha_t *p, char
*str)</code></dt>

<dd>解析を行います. 引数には, cabocha_new
で得られた cabocha_t 型のポインタと,<br>
各レイヤの1解析単位を1つの文字列で表現した char
型のポインタ文字列を与えます.<br>
デフォルトの動作ならば,
引数の文字列は生文となります.<br>
成功すれば, 解析後の結果が char
型のポインタとして返ってきます.<br>
戻り値のポインタが指すメモリ領域は,
呼び出し側で管理する必要はありませんが,<br>
cabocha_sparse_tostr を呼ぶ度に上書きされます.<br>
また, cabocha_destroy を呼ぶと解放されます. <br>
</dd>

<dt><code><font color="#dc143c">char *</font><font color=
"DarkBlue">cabocha_sparse_tostr2</font> (cabocha_t *m, char *str,
unsigned int len)</code></dt>

<dd>cabocha_sparse_tostr とほぼ同じですが, len にて,
解析する文の長さを指定できます. <br>
</dd>

<dt><code><font color="#dc143c">char *</font><font color=
"DarkBlue">cabocha_sparse_tostr3</font> (cabocha_t *m, char
*istr,unsigned int ilen char *ostr,unsigned int olen)</code></dt>

<dd>cabocha_sparse_tostr2 に加え, 出力用の
バッファ領域 (ostr), 及びその長さ (olen)
を指定できます. ostr の領域の管理は,
呼び出し側が行います. 成功すれば, 解析後の結果が
char 型のポインタとして返ってきます. これは, ostr
と同じになります. もし, 解析結果の長さが olen
以上になった場合は, 解析失敗とみなし, NULL
を返します. <br>
</dd>

<dt><code><font color="#dc143c">char *</font><font color=
"DarkBlue">cabocha_strerror</font> (cabocha_t* m)</code></dt>

<dd>エラーの内容を文字列として取得します.
cabocha_sparse_tostr 等で, NULL が返ってきた場合に,
cabocha_strerror を呼ぶことで,
エラーの内容を取得できます. cabocha_new,cabocha_new2
のエラーは, m を NULL と指定してください. <br>
</dd>

<dt><code><font color="#dc143c">void</font> <font color=
"DarkBlue">cabocha_destroy</font>(cabocha_t *p)</code></dt>

<dd>cabocha_t 型のポインタを解放します. <br>
</dd>
</dl>
</div>

<h2>C サンプル</h2>

<div style="margin-left: 2em">
<p>example.c</p>

<pre>
#include &lt;cabocha.h&gt;
#include &lt;stdio.h&gt;

int main (int argc, char **argv) 
{
   cabocha_t *c;
   char p[1024] = "太郎は次郎が持っている本を花子に渡した。";

   c = cabocha_new(argc, argv);

   printf ("INPUT: %s\n", p);
   printf ("RESULT:\n%s", cabocha_sparse_tostr(c, p));

   cabocha_destroy(c);
   
   return 0;
}
</pre>
</div>

<h2>C++ ライブラリ仕様</h2>

<div style="margin-left: 2em">
<p>準備中. src/cabocha.h, example/example2.cpp
を参考にしてください.</p>
</div>

<h2>コンパイル方法</h2>

<ul>
<li>UNIX の場合 

<pre>
% cc -O2 `cabocha-config --cflags` example.c -o example \
         `cabocha-config --libs`
</pre>
</li>

<li>Windows の場合 

<p>まず, コンパイル作業を行うディレクトリに cabocha.h, libcabocha.dll, をコピーします.<br>
この後の作業は, 使用するコンパイラによって微妙に変わります.</p>

<p>cygwin/mingw 環境の場合</p>
<pre>
% gcc -DDLL_IMPORT -I. example.c -o example.exe libcabocha.dll
</pre>
<br>
<br>

<p>Visual Studio .NET C++の場合</p>
<pre>
% cl -DDLL_IMPORT -I. example.c libcabocha.lib
</pre>

<p>BCC32 環境の場合</p>
<pre>
インポートライブラリの作成
% implib.exe /a /f libcabocha.lib libcabocha.dll
コンパイル
% bcc32 -DDLL_IMPORT -I. example.c libcabocha.lib
</pre>
<br>
<br>


<p>さらに, 以下例ように, libcabocha.dll と動的
にリンクすることも可能です. 以下の方法は,
どのようなコンパイラ (VCC, gcc, bcc)でも動作すると思います. この場合は,
インポートライブラリを作成する必要はありません.</p>

<pre>
#include &lt;stdio.h&gt;
#include &lt;windows.h&gt;

typedef void* (WINAPI *FPINIT)  (int, char **);
typedef char* (WINAPI *FPPARSE) (void*, char*);
typedef void  (WINAPI *FPDEL)   (void *);

int main (int argc, char **argv)
{
   char p[] = "太郎は次郎が持っている本を花子に渡した。";
   HINSTANCE hLib = LoadLibrary("libcabocha.dll");
   
   if (hLib) {

     FPINIT  fpInit  = (FPINIT)  GetProcAddress (hLib, "cabocha_new");
     FPPARSE fpParse = (FPPARSE) GetProcAddress (hLib, "cabocha_sparse_tostr");
     FPDEL   fpDel   = (FPDEL)   GetProcAddress (hLib, "cabocha_destroy");
      
     if (fpInit &amp;&amp; fpParse &amp;&amp; fpDel) {
       void *c = (*fpInit) (argc, argv);
       printf ("INPUT: %s\n", p);
       printf ("RESULT:\n%s", (*fpParse)(c, p));
       (*fpDel)(c);
     }
     FreeLibrary(hLib);
   }
   return 0;
}
</pre>

<br>
<br>
</li>
</ul>

<h2>Perl/Ruby/Python バインディング</h2>

<div style="margin-left: 2em">
<p>Perl, Ruby, Python といったスクリプト言語から, 直接
<b>CaboCha</b>を呼ぶことができます.<br>
詳しくは, ruby/README, perl/README, python/README
をご覧ください.</p>
</div>

<hr>
<p>$Id: libcabocha.html 1021 2003-01-30 17:26:15Z taku-ku $;</p>

<address>taku-ku@is.aist-nara.ac.jp</address>
</body>
</html>

